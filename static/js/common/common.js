var Authorization=$("#pageToken").val();if(!Authorization){Authorization="";}jQuery.support.cors=true;$.extend({aAjax:function(option){var defualts={beforeSend:function(request){checkLogin("gotoLogin");request.setRequestHeader("Authorization",Authorization);},contentType:"application/json",dataType:"json",xhrFields:{withCredentials:true},success:function(){},error:function(){},};$.ajax($.extend({},defualts,option));}});function checkLogin(type){if(Authorization.length<7){var thisLink=encodeURIComponent(top.location.href);if(typeof(type)=="undefined"||type=="gotoLogin"){top.location.href=ykyUrl.portal+"/login/redirect.htm?service="+thisLink;}return false;}else{return true;}}getUserData();function getUserData(){var cc=checkLogin("cc");var checkType=$(".topbase").length;if(cc&&checkType){var portalUrl=ykyUrl.transaction+"/v1/orders/statistics/user";$.aAjax({url:portalUrl,type:"GET",success:function(data){var allNum=data.totalCount;var waitPaid=data.waitPaid;var waitReceive=data.waitReceive;$(".allNum").text(allNum);$(".waitPaid").text(waitPaid);$(".waitReceive").text(waitReceive);}});}}var gotoCart={go:function(){var link=ykyUrl.customer+"/carts/new.htm?currency=";top.location.href=link+this.type;},type:"CNY"};function getQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);if(r!=null){return decodeURI(r[2]);}else{return"";}}function GetRequestWithout(url,param){if(url==null||url==""){return"";}var theRequest=new Object();var index=url.indexOf("?");if(index!=-1){var str_params=url.substr(index+1);var str_url=url.substr(0,index+1);strs=str_params.split("&");var temp;for(var i=0;i<strs.length;i++){temp=strs[i].split("=")[0];if(temp!=param){str_url+=strs[i];str_url+="&";}}str_url=str_url.substr(0,str_url.length-1);}return str_url;}Number.prototype.toFixed=function(s){var that=this,changenum,index;if(this<0){that=-that;}changenum=(parseInt(that*Math.pow(10,s)+0.5)/Math.pow(10,s)).toString();index=changenum.indexOf(".");if(index<0&&s>0){changenum=changenum+".";for(var i=0;i<s;i++){changenum=changenum+"0";}}else{index=changenum.length-index;for(var i=0;i<(s-index)+1;i++){changenum=changenum+"0";}}if(this<0){return -changenum;}else{return changenum;}};function setSubTitle(){var data=$("body").data();if(typeof data.title!="undefined"){var title=$(".sub_header h2");if(title.length){title.html(data.title);}return true;}return false;}setSubTitle();if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==="[object Array]";};}if(!Array.prototype.forEach){Array.prototype.forEach=function forEach(callback,thisArg){var T,k;if(this==null){throw new TypeError("this is null or not defined");}var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function"){throw new TypeError(callback+" is not a function");}if(arguments.length>1){T=thisArg;}k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O);}k++;}};}function applyTpl(tpl,value){var str="",values=Array.isArray(value)?value:[value],val;values.forEach(function(el){str+=tpl.replace(/{([^}]+)}/g,function($0,$1){if($1.indexOf(".")>-1){val=returnDeepVal($1,value);}else{val=el[$1]?el[$1]:"";}return val;});});return str;}function returnDeepVal(str,data){var arr=str.split(".");arr.forEach(function(e,index){if(e.indexOf("[]")>-1){e=e.replace("[]","");data=data[e];data=data[0];}else{data=data[e];}});return data;}(function($){var loading=function(text,obj){loading.init(text,obj);};loading.init=function(text,obj){var me=this;if(!this._wrapper||!$(".loadind-warp").length){this._wrapper=$("<div />");this._wrapper.addClass("loadind-warp");this._wrapper.html('<div class="loadind-warp-bg"></div> <div class="loadind-content"><div class="loadind-inner"><div class="loadind-text"> </div></div></div>');this._text=this._wrapper.find(".m-text");var $obj=document.body;if(obj){$obj=document.getElementById(obj);}this._wrapper.appendTo($obj);}this._text.text(text||"");};loading.hide=function(){if(this._wrapper&&$(".loadind-warp").length){this._wrapper.remove(".loadind-warp");}};$.loading=loading;})($);function retMsg(status,errmsg){var msg=errmsg||"服务器异常！";if(status===404){msg="访问不存在！"+errmsg;}else{if(status===400){msg="参数异常！"+errmsg;}else{if(status===401){msg="您无权限！"+errmsg;}else{if(status===428){msg="未登录！"+errmsg;}}}}return msg;}var syncData=function(api,type,params,callback,isAsync,showLoading){if(showLoading){$.loading("",showLoading);}type=type.toUpperCase();var newParams=null;if(params!=null){if(type=="POST"||type=="PUT"||type=="PATCH"){newParams=JSON.stringify(params);}else{if(type=="GET"||type=="DELETE"){newParams=$.param(params);}}}$.ajax({url:api,contentType:"application/json;charset=UTF-8",type:type,data:newParams,dataType:"json",async:isAsync==false?false:true,success:function(response,msg,res){if(showLoading){$.loading.hide();}if(res.status===200){callback(response,null);}else{callback(null,response);}},error:function(xhr,textStatus,errorThrown){if(showLoading){$.loading.hide();}if(xhr.status===200){callback(xhr.responseText,null);}else{var errMsg=xhr.responseJSON&&xhr.responseJSON.errMsg?xhr.responseJSON.errMsg:"";var msg=retMsg(xhr.status,errMsg);layer.msg(msg);callback(null,msg);}}});};Date.prototype.Format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length==1)?(o[k]):(("00"+o[k]).substr((""+o[k]).length)));}}return fmt;};