$(function(){placeholder();checkOnlyNumber();ykyPromotion.bestEcommerceReport();});"use strict";var canvasFlag=true;var canvasShow=function(){var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor){descriptor.writable=true;}Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps){defineProperties(Constructor.prototype,protoProps);}if(staticProps){defineProperties(Constructor,staticProps);}return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Progress=function(){function Progress(){var param=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,Progress);this.timestamp=null;this.duration=param.duration||Progress.CONST.DURATION;this.progress=0;this.delta=0;this.progress=0;this.isLoop=!!param.isLoop;this.reset();}Progress.prototype.reset=function reset(){this.timestamp=null;};Progress.prototype.start=function start(now){this.timestamp=now;};Progress.prototype.tick=function tick(now){if(this.timestamp){this.delta=now-this.timestamp;this.progress=Math.min(this.delta/this.duration,1);if(this.progress>=1&&this.isLoop){this.start(now);}return this.progress;}else{return 0;}};_createClass(Progress,null,[{key:"CONST",get:function get(){return{DURATION:1000};}}]);return Progress;}();var Confetti=function(){function Confetti(param){_classCallCheck(this,Confetti);if(!canvasFlag){return;}this.parent=param.elm||document.body;this.canvas=document.createElement("canvas");this.ctx=this.canvas.getContext("2d");this.width=param.width||this.parent.offsetWidth;this.height=param.height||this.parent.offsetHeight;this.length=param.length||Confetti.CONST.PAPER_LENGTH;this.yRange=param.yRange||this.height*2;this.progress=new Progress({duration:param.duration,isLoop:true});this.rotationRange=typeof param.rotationLength==="number"?param.rotationRange:10;this.speedRange=typeof param.speedRange==="number"?param.speedRange:10;this.sprites=[];this.canvas.style.cssText=["display: block","position: absolute","top: 0","left: 0","pointer-events: none","z-index: 999999"].join(";");this.render=this.render.bind(this);this.build();this.parent.append(this.canvas);this.progress.start(performance.now());requestAnimationFrame(this.render);}Confetti.prototype.build=function build(){for(var i=0;i<this.length;++i){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=Confetti.CONST.SPRITE_WIDTH;canvas.height=Confetti.CONST.SPRITE_HEIGHT;canvas.position={initX:Math.random()*this.width,initY:-canvas.height-Math.random()*this.yRange};canvas.rotation=this.rotationRange/2-Math.random()*this.rotationRange;canvas.speed=this.speedRange/2+Math.random()*(this.speedRange/2);ctx.save();ctx.fillStyle=Confetti.CONST.COLORS[Math.random()*Confetti.CONST.COLORS.length|0];ctx.fillRect(0,0,canvas.width,canvas.height);ctx.restore();this.sprites.push(canvas);}};Confetti.prototype.render=function render(now){var progress=this.progress.tick(now);this.canvas.width=this.width;this.canvas.height=this.height;for(var i=0;i<this.length;++i){this.ctx.save();this.ctx.translate(this.sprites[i].position.initX+this.sprites[i].rotation*Confetti.CONST.ROTATION_RATE*progress,this.sprites[i].position.initY+progress*(this.height+this.yRange));this.ctx.rotate(this.sprites[i].rotation);this.ctx.drawImage(this.sprites[i],-Confetti.CONST.SPRITE_WIDTH*Math.abs(Math.sin(progress*Math.PI*2*this.sprites[i].speed))/2,-Confetti.CONST.SPRITE_HEIGHT/2,Confetti.CONST.SPRITE_WIDTH*Math.abs(Math.sin(progress*Math.PI*2*this.sprites[i].speed)),Confetti.CONST.SPRITE_HEIGHT);this.ctx.restore();}requestAnimationFrame(this.render);};_createClass(Confetti,null,[{key:"CONST",get:function get(){return{SPRITE_WIDTH:4,SPRITE_HEIGHT:6,PAPER_LENGTH:150,DURATION:10000,ROTATION_RATE:100,COLORS:["#ea564b","#82a155","#3157b8","#f5f2a4"]};}}]);return Confetti;}();(function(){var DURATION=10000,LENGTH=200;if(canvasFlag){new Confetti({width:window.innerWidth,height:window.innerHeight,length:LENGTH,duration:DURATION});}if(canvasFlag){setTimeout(function(){new Confetti({width:window.innerWidth,height:window.innerHeight,length:LENGTH,duration:DURATION});},DURATION/2);}})();};var ykyPromotion={};ykyPromotion.bestEcommerceReport=function(){var animation=false,animationstring="animation",keyframeprefix="",domPrefixes="Webkit Moz O ms Khtml".split(" "),pfx="",elm=document.createElement("div");if(elm.style.animationName!==undefined){animation=true;}if(animation===false){for(var i=0;i<domPrefixes.length;i++){if(elm.style[domPrefixes[i]+"AnimationName"]!==undefined){pfx=domPrefixes[i];animationstring=pfx+"Animation";keyframeprefix="-"+pfx.toLowerCase()+"-";animation=true;break;}}}var addHtml='<div id="bestEcommerceReport" class="report_layer_wrap">'+'<div class="report_layer_shade" id="bestEcommerceReportShade" style="z-index: 999; background-color: rgb(0, 0, 0); opacity: 0.85;"></div>'+'<div class="best_ecommerce_cont"  style="z-index: 9999;">'+'<div class="best_ecommerce_shining" style="display:none;"><img src="'+ykyUrl._this+'/images/bestEcommerceReport/shining_effect.png" alt="" /></div>'+'<div class="best_ecommerce_bg">'+'<img src="'+ykyUrl._this+'/images/bestEcommerceReport/main_conent-2x.png" alt="" />"'+'<div class="best_ecommerce_cup"><img class="" src="'+ykyUrl._this+'/images/bestEcommerceReport/cup-2x.png" alt="" /></div>'+'<div class="best_ecommerce_planet"><img class="" src="'+ykyUrl._this+'/images/bestEcommerceReport/planet-2x.png" alt="" /></div>'+"</div>"+(animation?'<div class="best_ecommerce_vendor">':'<div class="best_ecommerce_vendor animation_not_support">')+'<div class="vendor_list_cont">'+'<img class="vendor_list1" src="'+ykyUrl._this+'/images/bestEcommerceReport/logo_top-2x.png" alt="" />'+'<img class="vendor_list2" class="" src="'+ykyUrl._this+'/images/bestEcommerceReport/logo_bottom-2x.png" alt="" />'+'<img class="vendor_list1" src="'+ykyUrl._this+'/images/bestEcommerceReport/logo_top-2x.png" alt="" />'+"</div>"+"</div>"+'<a class="best_ecommerce_close"><i class="icon-close_btn"></i></a>'+"</div>"+'<canvas class="canvasBox" width="1920" height="1000" style="display: block; position: absolute; top: 0px; left: 0px; pointer-events: none;z-index: 999999;"></canvas>'+'<canvas class="canvasBox" width="1920" height="1000" style="display: block; position: absolute; top: 0px; left: 0px; pointer-events: none;z-index: 999999;"></canvas>'+"</div>";var ReportTime={"start":(new Date("2017/10/20 22:00:00")).getTime(),"end":(new Date("2017/10/28 00:00:00")).getTime()};if(window.localStorage){var nowTime=(new Date()).Format("yyyy-MM-dd hh:mm:ss");var nowTimeDay=(new Date()).Format("yyyy-MM-dd");var nowTimeMesc=(new Date()).getTime();if(nowTimeMesc>=ReportTime.start&&nowTimeMesc<=ReportTime.end){if(localStorage.getItem("lastVisitTime")==undefined){localStorage.setItem("lastVisitTime",nowTime);if($("#bestEcommerceReport").length==0){try{canvasShow();}catch(e){}$(document.body).append(addHtml);$("#bestEcommerceReport >div").not(".report_layer_shade").addClass("animated bounceInDown");setTimeout(function(){$(".best_ecommerce_shining").show();},1000);}setTimeout(function(){$("canvas").remove();$("#bestEcommerceReport").remove();canvasFlag=false;},5000);}else{var lastVisitTime=(localStorage.getItem("lastVisitTime")).replace(/-/g,"/");var lastVisitDay=((new Date(lastVisitTime)).Format("yyyy-MM-dd"));if(lastVisitDay!=nowTimeDay){if($("#bestEcommerceReport").length==0){try{canvasShow();}catch(e){}$(document.body).append(addHtml);$("#bestEcommerceReport >div").not(".report_layer_shade").addClass("animated bounceInDown");setTimeout(function(){$(".best_ecommerce_shining").show();},1000);}setTimeout(function(){$("canvas").remove();$("#bestEcommerceReport").remove();canvasFlag=false;},5000);}localStorage.setItem("lastVisitTime",nowTime);}}}$(document).on("click","#bestEcommerceReport .best_ecommerce_close",function(){$("canvas").remove();$("#bestEcommerceReport").remove();canvasFlag=false;});};function checkOnlyNumber(){$(".onlynumber").keydown(function(event){return onlyDecimalKeyDown(event,false);});$(".onlynumber").keyup(function(){onlyDecimalByReplace(this,false);});$(".onlynumber").bind("paste",function(){var obj=this;setTimeout(function(){onlyDecimalByReplace(obj,false);},500);});$(".onlydecimal").keydown(function(event){return onlyDecimalKeyDown(event,true);});$(".onlydecimal").keyup(function(){onlyDecimalByReplace(this,true);});$(".onlydecimal").bind("paste",function(){var obj=this;setTimeout(function(){onlyDecimalByReplace(obj,true);},500);});}function onlyDecimalKeyDown(event,isDecimal){var target=event.srcElement;if(target==null){target=event.target;}if(!(event.keyCode>=48&&event.keyCode<=57)&&!(event.keyCode>=96&&event.keyCode<=117)&&(!isDecimal||event.keyCode!=190)&&event.keyCode!=188&&event.keyCode>46){if(layer){layer.tips("只能输入数字",$(target),{tips:[1,"#3595CC"],time:4000});}return false;}else{return true;}}function onlyDecimalByReplace(obj,isDecimal){var reg=null;if(isDecimal){reg=new RegExp("[^0-9.,]","g");}else{reg=new RegExp("[^0-9,]","g");}if(reg.test(obj.value)){obj.value=obj.value.replace(reg,"");}}String.prototype.replaceAll=function(con,rep){var reg=new RegExp(con,"g");return this.replace(reg,rep);};var placeholder=function(){$("input[placeholder],textarea[placeholder]").each(function(){var that=$(this),text=that.attr("placeholder");noplaceholder=that.attr("noplaceholder");if(noplaceholder=="true"){return true;}that.attr("placeholder","");var div=$("<div/>");if(that.css("float")){div.css("float",that.css("float"));}if(that.css("display")){div.css("display","inline-block");}var cssWidth=0;if(that.css("width")){cssWidth=parseInt(that.css("width").substring(0,that.css("width").indexOf("px")));}var cssPLeft=0;if(that.css("padding-left")){cssPLeft=parseInt(that.css("padding-left").substring(0,that.css("padding-left").indexOf("px")));}var cssPRight=0;if(that.css("padding-right")){cssPRight=parseInt(that.css("padding-right").substring(0,that.css("padding-right").indexOf("px")));}var cssBLeft=0;if(that.css("border-left-width")){cssBLeft=parseInt(that.css("border-left-width").substring(0,that.css("border-left-width").indexOf("px")));}var cssBRight=0;if(that.css("border-right-width")){cssBRight=parseInt(that.css("border-right-width").substring(0,that.css("border-right-width").indexOf("px")));}div.css("width",cssWidth+cssPLeft+cssPRight+cssBLeft+cssBRight+"px");that.css("width",cssWidth+"px");if(that.css("margin-left")){div.css("margin-left",that.css("margin-left"));that.css("margin-left","0px");}if(that.css("margin-top")){div.css("margin-top",that.css("margin-top"));that.css("margin-top","0px");}if(that.css("margin-bottom")){div.css("margin-bottom",that.css("margin-bottom"));that.css("margin-bottom","0px");}that.before(div);that.appendTo(div);var inputHolder=$("<div/>");inputHolder.text(text);that.before(inputHolder);inputHolder.css("font-size",that.css("font-size"));if(this.type=="textarea"){inputHolder.css("line-height","30px");}else{inputHolder.css("line-height",that.outerHeight()+"px");}inputHolder.css("padding-left","10px");inputHolder.css("vertical-align","middle");inputHolder.css("position","absolute");inputHolder.css("color","#cccccc");if(that.val()!=""){inputHolder.hide();}inputHolder.click(function(){inputHolder.hide();that.focus();});that.bind("focus",function(){inputHolder.hide();});that.bind("blur",function(){if(that.val()==""){inputHolder.show();}else{inputHolder.hide();}});});};var HtmlUtil={htmlEncode:function(html){var temp=document.createElement("div");(temp.textContent!=undefined)?(temp.textContent=html):(temp.innerText=html);var output=temp.innerHTML;temp=null;return output;},htmlDecode:function(text){var temp=document.createElement("div");temp.innerHTML=text;var output=temp.innerText||temp.textContent;temp=null;return output;}};