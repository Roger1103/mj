$(function(){checkActiveUrl();});function checkTitle(){for(var i=0;i<$(".message-detail p").length;i++){var title=$(".message-detail p").eq(i).text();$(".message-detail").eq(i).attr("title",title);}}function checkActiveUrl(){var len=$(".hot_active").length;if(len){for(var i=0;i<len;i++){var activeUrl=$(".hot_active").eq(i).attr("href");if(activeUrl.substring(0,2)!=="//"){var newUrl="//"+activeUrl;$(".hot_active").eq(i).attr("href",newUrl);}var checkUrl=activeUrl.replace(/\s/ig,"");if(checkUrl=="//"||checkUrl==""){$(".hot_active").eq(i).attr("href","javascript:void(0)");}}}}$(".top_img_close").on("click",function(){$(".top_img").addClass("dn");});function loadUserInfo(){if(hasLogin=="true"){$.aAjax({type:"GET",async:true,url:ykyUrl.party+"/v1/customersummery/summary",data:{},contentType:"application/json",success:function(data){if(data.accounttype=="ENTERPRISE_CUST"&&data.companyName!=""){if(data.companyName){$("#_showName").text(data.companyName);$("#_showName").attr("title",data.companyName);}else{$("#_showName").text(data.mail);$("#_showName").attr("title",data.mail);}$(".yky_box_img img").attr("src",data.logoUrl);$(".vip_person_img").css("display","none");}else{$(".yky_box_img img").attr("src",data.logoUrl);$("#_showName").text(data.mobile);$("#_showName").attr("title",data.mobile);$("#vipName").text(data.mobile);$(".vip_company_img").css("display","none");}},error:function(e){setTimeout(function(){layer.msg("查询用户登录信息失败。",{icon:2});},2000);}});}}var isHold;function showAllClass(){$(".categorys_dropdown").on("mouseenter",function(){clearTimeout(isHold);if($(".all_class.vh").length){openCat();}}).on("mouseleave",function(){isHold=setTimeout(closeCat,100);});$(".all_class").on("mouseenter",function(){clearTimeout(isHold);}).on("mouseleave",function(){isHold=setTimeout(closeCat,100);});var openCat=function(){$(".categorys_dropdown").addClass("categorys_active");$(".all_class").removeClass("vh");$(".all_class .menus .cat").eq(0).siblings(".cat").find("a").removeClass("active");$(".all_class .menus .cat").eq(0).find("a").addClass("active");$(".sub_menus_wrap").eq(0).removeClass("vh");$(".sub_menus_wrap").eq(0).siblings(".sub_menus_wrap").addClass("vh");},closeCat=function(){$(".categorys_dropdown").removeClass("categorys_active");$(".all_class .menus .cat").find("a").removeClass("active");$(".all_class .menus .mCSB_container").css("top",0);$(".all_class .menus").mCustomScrollbar("update");$(".sub_menus_wrap").eq(0).find(".sub_menus .mCSB_container").css("top",0);$(".all_class .sub_menus_wrap").eq(0).find(".sub_menus").mCustomScrollbar("update");$(".sub_menus_wrap").addClass("vh");$(".all_class").addClass("vh");};}function setAllClass(){$(".all_class").on("mouseover",".menus .cat",function(){var id=$(this).attr("id");$(this).find("a").addClass("active");$(this).siblings("li").find("a").removeClass("active");$("#sub_"+id).removeClass("vh");$("#sub_"+id).siblings(".sub_menus_wrap").addClass("vh");});function gunD(){if($(".menus").length){$(".menus").mCustomScrollbar();}if($(".sub_menus").length){$(".sub_menus").mCustomScrollbar();}}var sub=".all_class .drp_cat";if(sub){setTimeout(gunD,200);}function createSubMenus(i,id,c){var subAll="";var iStr="";$.each(c.children,function(index,cc){iStr+=subClass(cc);});subAll='<ul class="sub_menus vh mCustomScrollbar _mCS_3" id="sub_'+id+'">'+'<li class="item">'+'<div class="channels">'+iStr+"</div>"+"</li>"+"</ul>";return subAll;}function subClass(sub){var mStr="";$.each(sub.children,function(i,m){mStr+=createSubItem(m);});var innerStr="<dl>"+"<dt>"+'<a target="_blank" href="'+ykyUrl._this+"/search/inventory/cate/"+sub.id+'.htm">'+sub.name+"</a>"+"</dt>"+"<dd>"+mStr+"</dd>"+"</dl>";return innerStr;}function createSubItem(m){var itemStart="";if(m&&m.style&&m.style.fontColor=="red"){itemStart='<a style="color: #b2100d;" target="_blank" href="'+ykyUrl._this+"/search/inventory/cate/"+m.id+'.htm">'+m.name+"</a>";}else{itemStart='<a target="_blank" href="'+ykyUrl._this+"/search/inventory/cate/"+m.id+'.htm">'+m.name+"</a>";}return itemStart;}}var placeholder=function(){$("input[placeholder],textarea[placeholder]").each(function(){var that=$(this),text=that.attr("placeholder");that.attr("placeholder","");var div=$("<div/>");if(that.css("float")){div.css("float",that.css("float"));}if(that.css("display")){div.css("display","inline-block");}var cssWidth=0;if(that.css("width")){cssWidth=parseInt(that.css("width").substring(0,that.css("width").indexOf("px")));}var cssPLeft=0;if(that.css("padding-left")){cssPLeft=parseInt(that.css("padding-left").substring(0,that.css("padding-left").indexOf("px")));}var cssPRight=0;if(that.css("padding-right")){cssPRight=parseInt(that.css("padding-right").substring(0,that.css("padding-right").indexOf("px")));}var cssBLeft=0;if(that.css("border-left-width")){cssBLeft=parseInt(that.css("border-left-width").substring(0,that.css("border-left-width").indexOf("px")));}var cssBRight=0;if(that.css("border-right-width")){cssBRight=parseInt(that.css("border-right-width").substring(0,that.css("border-right-width").indexOf("px")));}div.css("width",cssWidth+cssPLeft+cssPRight+cssBLeft+cssBRight+"px");that.css("width",cssWidth+"px");if(that.css("margin-left")){div.css("margin-left",that.css("margin-left"));that.css("margin-left","0px");}if(that.css("margin-top")){div.css("margin-top",that.css("margin-top"));that.css("margin-top","0px");}if(that.css("margin-bottom")){div.css("margin-bottom",that.css("margin-bottom"));that.css("margin-bottom","0px");}that.before(div);that.appendTo(div);var inputHolder=$("<div/>");inputHolder.text(text);that.before(inputHolder);inputHolder.css("font-size",that.css("font-size"));if(this.type=="textarea"){inputHolder.css("line-height","30px");}else{inputHolder.css("line-height",that.outerHeight()+"px");}inputHolder.css("padding-left",cssPLeft+"px");inputHolder.css("vertical-align","middle");inputHolder.css("position","absolute");inputHolder.css("color","#999");$(".footer_search_box").children("div").children("div").css("color","#fff");inputHolder.css("top","0px");if(that.val()!=""){inputHolder.hide();$("#hSearch .hot_word").hide();}inputHolder.click(function(){$("#hSearch .hot_word").hide();inputHolder.hide();that.focus();});that.bind("focus",function(){inputHolder.hide();$("#hSearch .hot_word").hide();});that.bind("blur",function(){if(that.val()==""){inputHolder.show();$("#hSearch .hot_word").show();}else{inputHolder.hide();$("#hSearch .hot_word").hide();}});});};function search(type){var keyword="";var keywordVal="";if(type=="index"){keywordVal=$.trim($("#_condition").val());keyword=keywordVal.replace(/\//g,"%2F");keyword=keyword.replace(/\\/g,"%5C");}else{keywordVal=$.trim($("#inputSearch").val());keyword=keywordVal.replace(/\//g,"%2F");keyword=keyword.replace(/\\/g,"%5C");}if(keyword){setKeyWord(keywordVal);window.location.href=ykyUrl._this+"/search/?s="+encodeURIComponent(keyword);}else{window.location.href=ykyUrl._this+"/search/?s=";}}var showMore;$("#_condition").keyup(function(event){showMore=showPredictive(1);if(event.keyCode==13){search("index");ga("send","event","搜索","回车搜索","首页");}});$("#inputSearch").keyup(function(event){showMore=showPredictive(2);if(event.keyCode==13){search();ga("send","event","搜索","回车搜索","首页");}});$("#_condition").on("focus",function(){showPredictive(1);});$("#_condition").on("blur",function(){closeKeyWord(1);});$("#inputSearch").on("focus",function(){showPredictive(2);});$("#inputSearch").on("blur",function(){closeKeyWord(2);});function showPredictive(type){clearTimeout(showMore);return setTimeout(function(){var val="";if(type==1){val=$.trim($("#_condition").val());}else{val=$.trim($("#inputSearch").val());}if(val!=""){var list="",html="";$.ajax({type:"GET",async:true,url:ykyUrl.product+"/v1/products/keyword/association",data:{"keyword":val},contentType:"application/json",success:function(data){if(data.length>0){var len=data.length<10?data.length:10;for(var i=0;i<len;i++){list+="<li><a href="+ykyUrl._this+"/search/?s="+checkUrlKey(data[i])+data[i]+"</a></li>";}html="<ul class='has_kw'>"+list+"</ul>";if(type==1){$(".from_cont .predictive_box .no_kw").remove();$(".from_cont .predictive_box .has_kw").remove();$(".from_cont .predictive_box").append(html);$(".from_cont .predictive_box").removeClass("dsn");}else{$(".footer_search_box .predictive_box .no_kw").remove();$(".footer_search_box .predictive_box .has_kw").remove();$(".footer_search_box .predictive_box").append(html);$(".footer_search_box .predictive_box").removeClass("dsn");}}else{$(".predictive_box").addClass("dsn");}},error:function(e){}});}else{var option=JSON.parse(localStorage.getItem("searchWord"));var list="",html="";if(option&&option.length>0){var len=option.length<10?option.length:10;for(var i=0;i<len;i++){list+="<li><a title="+option[i]+" href="+ykyUrl._this+"/search/?s="+checkUrlKey(option[i])+">"+option[i]+"</a><i class='predictive-delete'>历史记录</i></li>";}html="<ul class='no_kw'>"+list+"<li class='mb10'><i class='predictive-allDelete'>删除全部</i></li></ul>";if(type==1){$(".from_cont .predictive_box .no_kw").remove();$(".from_cont .predictive_box .has_kw").remove();$(".from_cont .predictive_box").append(html);$(".from_cont .predictive_box").removeClass("dsn");}else{$(".footer_search_box .predictive_box .no_kw").remove();$(".footer_search_box .predictive_box .has_kw").remove();$(".footer_search_box .predictive_box").append(html);$(".footer_search_box .predictive_box").removeClass("dsn");}}else{$(".predictive_box").addClass("dsn");}}},200);}function checkUrlKey(key){var keyWord=key.replace(/\//g,"%2F"),keyWord=keyWord.replace(/\\/g,"%5C"),keyWord=encodeURIComponent(keyWord);return keyWord;}function setKeyWord(val){if(val!=""){var option=localStorage.getItem("searchWord")?JSON.parse(localStorage.getItem("searchWord")):[];for(var i=0;i<option.length;i++){if(option[i]==val){option.splice(i,1);}}option.unshift(val);if(option.length>10){option=option.slice(0,10);}localStorage.setItem("searchWord",JSON.stringify(option));}}function closeKeyWord(type){if(type==1){if($(".from_cont .predictive_box").hasClass("active")){}else{$(".from_cont .predictive_box").addClass("dsn");}}else{if($(".footer_search_box .predictive_box").hasClass("active")){}else{$(".footer_search_box .predictive_box").addClass("dsn");}}}$(".predictive_box").hover(function(){$(this).addClass("active");},function(){$(this).removeClass("active");});$(".predictive_box").on("mouseover","li",function(){$(this).find(".predictive-delete").text("删除").css("","");});$(".predictive_box").on("mouseout","li",function(){$(this).find(".predictive-delete").text("历史记录").css("","");});$(".from_cont .predictive_box").on("click",".predictive-delete",function(){var option=JSON.parse(localStorage.getItem("searchWord"));var str=$(this).siblings("a").text();var len=option.length<10?option.length:10;for(var i=0;i<len;i++){if(option[i]==str){option.splice(i,1);}}localStorage.setItem("searchWord",JSON.stringify(option));showPredictive(1);});$(".footer_search_box .predictive_box").on("click",".predictive-delete",function(){var option=JSON.parse(localStorage.getItem("searchWord"));var str=$(this).siblings("a").text();var len=option.length<10?option.length:10;for(var i=0;i<len;i++){if(option[i]==str){option.splice(i,1);}}localStorage.setItem("searchWord",JSON.stringify(option));showPredictive(2);});$(".predictive_box").on("click",".predictive-allDelete",function(){localStorage.removeItem("searchWord");$(".predictive_box").addClass("dsn");});$(".predictive_box").on("click",".has_kw a",function(){var option=localStorage.getItem("searchWord")?JSON.parse(localStorage.getItem("searchWord")):[];var str=$(this).text();for(var i=0;i<option.length;i++){if(option[i]==str){return;}}option.unshift(str);localStorage.setItem("searchWord",JSON.stringify(option));});$(".top_user li").eq(0).on("click",function(){ga("send","event","用户登录","点击登录","首页");});$(".top_user li").eq(1).on("click",function(){ga("send","event","用户注册","点击注册","首页");});$(".top-promote").on("click",function(){var title=$(this).attr("data-name");ga("t0.ec:addPromo",{"name":title});ga("t0.ec:setAction","promo_click");ga("send","event","推广","点击推广-"+title,"首页");});$(".top_img_close").on("click",function(){ga("send","event","推广","点击关闭推广","首页");});$(".logo").on("click",function(){ga("send","event","返回首页","点击Logo","首页");});$(".all_class").on("click",".drp_cat a",function(){var val=$(this).text();ga("send","event","产品分类","点击产品分类-"+val,"首页");});$(".bom-offer").on("click",function(){ga("send","event","频道","点击频道-BOM报价","首页");});$(".top-vendor").on("click",function(){ga("send","event","频道","点击频道-授权分销商","首页");});$(".top-brand").on("click",function(){ga("send","event","频道","点击频道-原厂目录","首页");});$(".search-button").on("click",function(){ga("send","event","搜索","点击搜索","首页");});$(".predictive_box").on("click","a",function(){ga("send","event","搜索","点击智能提示搜索","首页");});$(".go-enquiry").on("click",function(){ga("send","event","询价","点击立即询价","首页");});$(".banner_show li").on("click",function(){var title=$(this).attr("data-name");ga("t0.ec:addPromo",{"name":title});ga("t0.ec:setAction","promo_click");ga("send","event","推广","点击推广-"+title,"首页");});$(".choice_item a").on("click",function(){var num=$(this).attr("data-name");ga("send","event","热销产品","点击热销产品-"+num,"首页");});$(".more-hot-product a").on("click",function(){ga("send","event","热销产品","点击热销查看更多","首页");});$(".supplier-box li").on("click",function(){var title=$(this).attr("data-name");ga("send","event","精选供应商","点击精选供应商-"+title,"首页");});$(".all-vendor a").on("click",function(){ga("send","event","精选供应商","点击精选供应商查看更多","首页");});$(".bom_img a").on("click",function(){var title=$(this).attr("data-name");ga("send","event","BOM急速报价","点击BOM急速报价-"+title,"首页");});$(".more_bom a").on("click",function(){ga("send","event","BOM急速报价","点击立即获取免费报价","首页");});$(".introduce_content a").on("click",function(){var title=$(this).attr("data-name");ga("send","event","公告资讯","点击媒体动态-"+title,"首页");});$(".show-more").on("click",function(){ga("send","event","公告资讯","点击媒体动态查看更多","首页");});$(".footer_search_img").on("click",function(){ga("send","event","搜索","点击底部搜索","首页");});$(".footer-click a").on("click",function(){var title=$(this).text();ga("send","event","页尾链接","点击页尾链接-"+title,"首页");});